/*! For license information please see egdpr.js.LICENSE.txt */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=0)}([function(e,t,n){e.exports=n(3)},function(e,t,n){var r,i;!function(o){if(void 0===(i="function"==typeof(r=o)?r.call(t,n,t,e):r)||(e.exports=i),!0,e.exports=o(),!!0){var s=window.Cookies,a=window.Cookies=o();a.noConflict=function(){return window.Cookies=s,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function i(){}function o(t,n,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},i.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var u in o)o[u]&&(a+="; "+u,!0!==o[u]&&(a+="="+o[u].split(";")[0]));return document.cookie=t+"="+n+a}}function s(e,n){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],s=0;s<o.length;s++){var a=o[s].split("="),u=a.slice(1).join("=");n||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var c=t(a[0]);if(u=(r.read||r)(u,c)||t(u),n)try{u=JSON.parse(u)}catch(e){}if(i[c]=u,e===c)break}catch(e){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,n){o(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))}))},function(e,t,n){var r,i,o;o=function(){var e,t,n=document,r=n.getElementsByTagName("head")[0],i={},o={},s={},a={};function u(e,t){for(var n=0,r=e.length;n<r;++n)if(!t(e[n]))return!1;return 1}function c(e,t){u(e,(function(e){return t(e),1}))}function l(t,n,r){t=t.push?t:[t];var h=n&&n.call,v=h?n:r,p=h?t.join(""):n,d=t.length;function g(e){return e.call?e():i[e]}function y(){if(!--d)for(var e in i[p]=1,v&&v(),s)u(e.split("|"),g)&&!c(s[e],g)&&(s[e]=[])}return setTimeout((function(){c(t,(function t(n,r){return null===n?y():(r||/^https?:\/\//.test(n)||!e||(n=-1===n.indexOf(".js")?e+n+".js":e+n),a[n]?(p&&(o[p]=1),2==a[n]?y():setTimeout((function(){t(n,!0)}),0)):(a[n]=1,p&&(o[p]=1),void f(n,y)))}))}),0),l}function f(e,i){var o,s=n.createElement("script");s.onload=s.onerror=s.onreadystatechange=function(){s.readyState&&!/^c|loade/.test(s.readyState)||o||(s.onload=s.onreadystatechange=null,o=1,a[e]=2,i())},s.async=1,s.src=t?e+(-1===e.indexOf("?")?"?":"&")+t:e,r.insertBefore(s,r.lastChild)}return l.get=f,l.order=function(e,t,n){!function r(i){i=e.shift(),e.length?l(i,r):l(i,t,n)}()},l.path=function(t){e=t},l.urlArgs=function(e){t=e},l.ready=function(e,t,n){e=e.push?e:[e];var r,o=[];return!c(e,(function(e){i[e]||o.push(e)}))&&u(e,(function(e){return i[e]}))?t():(r=e.join("|"),s[r]=s[r]||[],s[r].push(t),n&&n(o)),l},l.done=function(e){l([null],e)},l},e.exports?e.exports=o():void 0===(i="function"==typeof(r=o)?r.call(t,n,t,e):r)||(e.exports=i)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.r(t),n.d(t,"eGDPR",(function(){return Ve})),n.d(t,"eGDPRService",(function(){return Ge}));var i="egdpr",o="data-egdpr-",s=function(e,t){return(e=e.weight)>(t=t.weight)?1:e<t?-1:0},a=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=[];for(var o in e){var s=r(e[o]),a=r(t[o]);s!==a&&i.push({type:s,name:o,value:t[o],valueType:a})}if(i.length){if(n){var u="\r\n\t - ",c=u+i.map((function(e){return"waiting for ".concat(e.name," (").concat(e.type,") and got value ").concat(e.value," (").concat(e.valueType,") ")})).join(u);throw"The object ".concat(t," does not match interface ").concat(e,". Here are missing or bad typed properties : ").concat(c," \r\n Please check the doc to make your service valid")}return!1}return!0},u="group-list-has-changed",c="group-list-has-changed";function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=n(1),h=1,v=-1,p=0,d=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getServiceStatus",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getData();return void 0!==n[e.id]?n[e.id]:t?(this.setServiceStatus(e,v),this.getServiceStatus(e,!1)):v}},{key:"setServiceStatus",value:function(e,t){var n=this.getData();n[e.id]=t,f.set(i,n)}},{key:"getData",value:function(){var e={};try{e=JSON.parse(f.get(i))}catch(e){}return e}}])&&l(t.prototype,n),r&&l(t,r),e}());function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t,this._name=n,this._description=r,this.services=[]}var t,n,r;return t=e,(n=[{key:"isMandatory",value:function(){return this.services.filter((function(e){return e.isMandatory()})).length===this.services.length}},{key:"addService",value:function(e){var t=this;return e&&(Array.isArray(e)?e.map((function(e){return t._doAddService(e)})):this._doAddService(e)),this}},{key:"getServicesList",value:function(){return this.services}},{key:"_doAddService",value:function(e){var t=Re.getServiceManager().getServiceById(e.id);return t&&(this.services.push(t),this.services=this.services.sort((function(e,t){return s(e,t)})),Re.trigger(c,{group:this})),this}},{key:"enableAll",value:function(){return Re.getServiceManager().enableService(this.services),this}},{key:"disableAll",value:function(){return Re.getServiceManager().disableService(this.services),this}},{key:"toggleAll",value:function(){return this.status!==h?this.enableAll():this.disableAll(),this}},{key:"setWeight",value:function(e){return this.weight=e,Re.getGroupManager().getGroupById(this.id)&&Re.trigger(c,{group:this}),this}},{key:"id",get:function(){return this._id},set:function(e){this._id=e,Re.trigger(ServiceEvents.groupHasChanged,{group:this})}},{key:"name",get:function(){return this._name},set:function(e){this._name=e,Re.trigger(c,{group:this})}},{key:"description",get:function(){return this._description},set:function(e){this._description=e,Re.trigger(c,{group:this})}},{key:"status",get:function(){var e=this.services.length;return this.services.filter((function(e){return e.isEnabled()})).length===e?h:this.services.filter((function(e){return e.isDisabled()})).length===e?p:v}}])&&g(t.prototype,n),r&&g(t,r),e}(),b="needs-rebuild",w="has-rebuild",m="show-view",S="hide-view";function k(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.groups=[]}var t,n,r;return t=e,(n=[{key:"init",value:function(){var e=this;Re.on(u).subscribe((function(t,n){return e.sortGroups()})),Re.on(c).subscribe((function(t,n){return e.sortGroups()}))}},{key:"createGroup",value:function(e,t,n){if(!this.getGroupById(e)){var r=new y(e,t,n);return r.weight=void 0!==r.weight?r.weight:this.groups.length,this.groups.push(r),this.sortGroups(),Re.trigger(u,{groupManager:this}),r}if(this.logs)throw"Group ".concat(e," already exists");return!1}},{key:"getGroupsList",value:function(){return this.groups}},{key:"getGroupById",value:function(e){return this.groups.filter((function(t){return t.id===e}))[0]}},{key:"sortGroups",value:function(){return this.groups=this.groups.sort((function(e,t){return s(e,t)})),Re.trigger(b),this}},{key:"getUnGroupedServices",value:function(){var e=[];return this.groups.map((function(t){e=e.concat(t.getServicesList().map((function(e){return e.id})))})),e=k(new Set(e)),Re.getServiceManager().getServicesList().map((function(e){return e.id})).filter((function(t){return-1===e.indexOf(t)})).map((function(e){return Re.getServiceManager().getServiceById(e)}))}}])&&O(t.prototype,n),r&&O(t,r),e}()),E="service-list-has-changed",M="service-has-changed",D="service-status-has-changed",P="service-start",j="service-stop";function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var V=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enableCache=!0,this.tryRegionalisation=!1;var t=this.getUserLanguage();this.translations={},this.translations[t]={},this.alreadyLoaded=[]}var t,n,r;return t=e,(n=[{key:"init",value:function(){}},{key:"hasToLoadTranslation",value:function(e){var t=this.getUserLanguage();return this.tryRegionalisation&&e!==t||!this.tryRegionalisation&&e.split("-")[0]!==t.split("-")[0]}},{key:"setDefaultLanguage",value:function(e){this.defaultLanguage=e}},{key:"allowTryRegionalisation",value:function(){return this.tryRegionalisation=!0,this}},{key:"getUserLanguage",value:function(){return this.userLanguage||(this.userLanguage=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLang||null),this.userLanguage}},{key:"addTranslation",value:function(e,t){if("string"==typeof t){if(t.indexOf("%")>-1)return this.loadFile(t),this;throw'The translation path does not have a "'.concat("%",'" to replace')}this._doAddTranslation(e,t,!0)}},{key:"loadUserLanguageData",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.addTranslation(this.languageBaseUrl)}},{key:"loadFile",value:function(e){var t=this.getUserLanguage();t=this.tryRegionalisation?t:t.split("-")[0];var n=e.split("%").join(t);if(!(this.alreadyLoaded.indexOf(n)>-1)){var r=this.getStoredTranslationByPath(n);r?this._doAddTranslation(n,r):this._doLoadFile(n,t)}}},{key:"_doLoadFile",value:function(e,t){var n=this;this.loadTranslationFile(e,t).then((function(e){n.loadFileContent(e)})).catch((function(t){t.language.indexOf("-")>-1&&n.tryRegionalisation?n.loadFile(e):function(e){console.error("Cannot load translation file ".concat(e.path))}(t)}))}},{key:"loadFileContent",value:function(e){try{var t=JSON.parse(e.result);this.storeLanguage(e.path,t),this._doAddTranslation(e.path,t)}catch(t){console.error("translation file is not correct (".concat(e.path,")"))}}},{key:"_doAddTranslation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._appendTranslation(this.getUserLanguage(),t,n),this.alreadyLoaded.push(e),this.onLoadString()}},{key:"_appendTranslation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.translations[e]||(this.translations[e]=t),this.translations[e]=n?C({},this.translations[e],{},t):C({},t,{},this.translations[e])}},{key:"storeLanguage",value:function(e,t){if(this.enableCache){var n=this.getStoredLanguages();n&&(n[e]=t,localStorage.setItem(i+"l",JSON.stringify(n)))}}},{key:"getStoredLanguages",value:function(){if(void 0!==("undefined"==typeof localStorage?"undefined":L(localStorage))){var e={};try{e=JSON.parse(localStorage.getItem(i+"l"))}catch(e){}return e||{}}return null}},{key:"getStoredTranslationByPath",value:function(e){var t=this.getStoredLanguages();return!!t&&t[e]}},{key:"loadTranslationFile",value:function(e,t){return new Promise((function(n,r){var i=new XMLHttpRequest,o={path:e,language:t};i.onload=function(){i.status>=200&&i.status<300?(o.result=i.response,n(o)):r(o)},i.onerror=function(){r(o)},i.open("get",o.path),i.send()}))}},{key:"onLoadString",value:function(){var e=this;document.querySelectorAll("[".concat(o,"l]")).forEach((function(t){var n=null;try{n=JSON.parse(decodeURIComponent(t.getAttribute(o+"l-data")))}catch(e){n=null}t.innerHTML=e.translate(t.getAttribute(o+"l"),n)}))}},{key:"translate",value:function(e,t){var n=this.translations[this.getUserLanguage()][e]||e;return t&&Object.keys(t).map((function(e){n=n.split(e).join(t[e])})),n}},{key:"html",value:function(e,t){var n=encodeURIComponent(JSON.stringify(t));return"<span ".concat(o,'l="').concat(e,'" ').concat(t?"".concat(o,'l-data="').concat(n,'"'):"",">").concat(this.translate(e,t),"</span>")}}])&&R(t.prototype,n),r&&R(t,r),e}()),G=function(e,t){return V.html(e,t)};function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.localManager=V,this.defaultLanguage="en",this.translations=this.getDefaultTranslations()}var t,n,r;return t=e,(n=[{key:"init",value:function(){var e=this;return this.getTranslations().map((function(t,n){var r="".concat(e.id,"-").concat(n);"string"==typeof t?e.localManager.hasToLoadTranslation(e.getDefaultLanguage())&&e.localManager.addTranslation(r,t):e.localManager.addTranslation(r,t)})),this}},{key:"setDefaultLanguage",value:function(e){return this.defaultLanguage=e,this}},{key:"getDefaultLanguage",value:function(){return this.defaultLanguage}},{key:"getDefaultTranslations",value:function(){return[]}},{key:"getTranslations",value:function(){return this.translations}},{key:"setTranslations",value:function(e){return this.translations=e,this}},{key:"addTranslation",value:function(e){return this.translations.push(e),this}}])&&I(t.prototype,n),r&&I(t,r),e}();function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return!t||"object"!==B(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(s,e);var t,n,r,i,o=(t=s,function(){var e,n=F(t);if(q()){var r=F(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return N(this,e)});function s(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(r=o.call(this,e))._id=e,r._name=t,r._description=n,r}return n=s,(r=[{key:"getCookiePatterns",value:function(){return[]}},{key:"getRelatedScripts",value:function(){return[]}},{key:"getRelatedCss",value:function(){return[]}},{key:"onEnable",value:function(){}},{key:"onDisable",value:function(){}},{key:"start",value:function(){console.log("Start ".concat(this.name," (").concat(this.id,")"))}},{key:"stop",value:function(){console.log("Stop ".concat(this.name," (").concat(this.id,")"))}},{key:"isMandatory",value:function(){return!1}},{key:"isEnabled",value:function(){return this.status===h}},{key:"isDisabled",value:function(){return this.status===p}},{key:"isPending",value:function(){return this.status===v}},{key:"setWeight",value:function(e){return this.weight=e,Re.getServiceManager().getServiceById(this.id)&&Re.trigger(E,{serviceManager:Re.getServiceManager()}),this}},{key:"id",get:function(){return this._id},set:function(e){this._id=e,Re.trigger(M,{service:this})}},{key:"name",get:function(){return this._name},set:function(e){this._name=e,Re.trigger(M,{service:this})}},{key:"description",get:function(){return this._description},set:function(e){this._description=e,Re.trigger(M,{service:this})}},{key:"status",get:function(){return d.getServiceStatus(this)}}])&&H(n.prototype,r),i&&H(n,i),s}(U);function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var W={id:"id",name:"Name",description:"description",start:function(){}},X=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.services=[]}var t,n,r;return t=e,(n=[{key:"getServicesList",value:function(){return this.services}},{key:"getEnabledServicesList",value:function(){return this.services.filter((function(e){return e.isEnabled()}))}},{key:"getDisabledServicesList",value:function(){return this.services.filter((function(e){return e.isDisabled()}))}},{key:"getPendingServices",value:function(){return this.services.filter((function(e){return e.isPending()}))}},{key:"getMandatoryServicesList",value:function(){return this.services.filter((function(e){return e.isMandatory()}))}},{key:"init",value:function(){var e=this;Re.on(E).subscribe((function(t,n){return e.sortServices()}))}},{key:"createService",value:function(e){var t=e;if(!this.isService(e)&&!(t=this.overrideService(e)))return null;if(this.getServiceById(t.id))throw"Service ".concat(id," already exists");return t.weight=void 0!==e.weight?t.weight:this.services.length,t.init(),this.services.push(t),t.isEnabled()&&this.startService(t),Re.trigger(E,{services:this.services}),t}},{key:"overrideService",value:function(e){var t=null;if(a(W,e,Re.logsAreEnabled())){for(var n in t=new Y,e)t[n]=e[n];Object.getOwnPropertyNames(Object.getPrototypeOf(e)).indexOf("start")>-1&&(Object.getOwnPropertyNames(Object.getPrototypeOf(e)).map((function(n){t[n]=e[n]})),"function"==typeof e.getDefaultTranslations&&t.setTranslations(e.getDefaultTranslations()))}return t}},{key:"getServiceById",value:function(e){return this.services.filter((function(t){return t.id===e}))[0]}},{key:"sortServices",value:function(){return this.services.length>1&&(this.services=this.services.sort((function(e,t){return s(e,t)}))),this}},{key:"isService",value:function(e){return e instanceof Y}},{key:"enableAll",value:function(){this.enableService(this.services)}},{key:"enableService",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Array.isArray(e)?(e.map((function(e){t.enableService(e,!1)})),Re.trigger(D,{service:e})):e.isEnabled()||(d.setServiceStatus(e,h),e.onEnable(),this.startService(e),n&&Re.trigger(D,{service:e}))}},{key:"startService",value:function(e){e.getRelatedScripts().map((function(e){if("string"==typeof e)Re.addScript(e);else try{e.path&&Re.addScript(e.path,e.callback)}catch(e){console.error(e)}})),e.start(),Re.trigger(P,{service:e})}},{key:"disableAll",value:function(){this.disableService(this.services)}},{key:"disableService",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(Array.isArray(e))e.map((function(e){t.disableService(e,!1)})),Re.trigger(D,{service:e});else{var r=e.isEnabled();!r&&!e.isPending()||e.isMandatory()||(e.isEnabled()&&(this.stopService(e),e.onDisable()),d.setServiceStatus(e,p),n&&Re.trigger(D,{service:e}))}}},{key:"stopService",value:function(e){e.stop();try{var t=Object.keys(f.get()),n=e.getCookiePatterns();t.length&&n.length&&t.filter((function(e){for(var t in n)if(e.match(n[t]))return!0;return!1})).map((function(e){f.remove(e)}))}catch(e){}e.getRelatedScripts().map((function(e){"string"==typeof e?Re.removeScript(e):e.path&&Re.removeScript(e.path)})),Re.trigger(j,{service:e})}},{key:"toggleService",value:function(e){e.isEnabled()?this.disableService(e):this.enableService(e)}}])&&z(t.prototype,n),r&&z(t,r),e}());function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t,n){return(K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=te(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Q(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(u,e);var t,n,r,s,a=(t=u,function(){var e,n=te(t);if(ee()){var r=te(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Q(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this,e)).css=t.getDefaultCssList(),t}return n=u,(r=[{key:"initTemplate",value:function(){K(te(u.prototype),"init",this).call(this),this.getCssList().map((function(e){return Re.addCss(e)}))}},{key:"getDefaultCssList",value:function(){return[]}},{key:"getCssList",value:function(){return this.css}},{key:"setCssList",value:function(e){return this.css=e,this}},{key:"wrapper",value:function(e){return'\n        <div class="'.concat(i,'-view-wrapper">\n            <div class="').concat(i,'-view">\n                <span class="').concat(i,'-view-hide" ').concat(o,'view-hide>close</span>\n                <div class="').concat(i,'-view-content">\n                    ').concat(e,"\n                </div>\n            </div>\n        </div>")}},{key:"getNoServiceMarkup",value:function(){var e='\n            <div class="'.concat(i,'-view-main">\n                <div class="title">').concat(this.html("Vos données personnelles"),'</div>\n                <div class="').concat(i,'-view-head">\n                    ').concat(this.html("Ce site ne déclare pas de services qui pourraient recquérir et exploiter des données personnelles."),"\n                </div>\n            </div>");return this.wrapper(e)}},{key:"getContent",value:function(e){return'\n        <div class="'.concat(i,'-view-main">\n            <div class="title">').concat(G("Vos données personnelles"),'</div>\n            <div class="').concat(i,'-view-head">        \n                ').concat(G("Ce site utilise des services pour améliorer votre expérience utilisateur et vous proposer certains contenus externes. \n                Certains de ces services peuvent recquérir et exploiter des données personnelles. \n                Vous pouvez gérer leur activation via ce panneau accessible à tout moment.<br/>Vous pouvez également accéder et gérer en détail l'ensemble des services que le site propose."),'\n            </div>\n\n            <div class="').concat(i,'-view-quick">\n                <button ').concat(o,'all-enable="accept_all">').concat(G("Tout accepter"),"</button>\n                <button ").concat(o,'all-disable="deny_all">').concat(G("Tout refuser"),"</button>\n                <button ").concat(o,"view-toggle-detail>").concat(G("Voir le détail"),'</button>\n            </div>\n        </div>\n        <div class="').concat(i,'-view-detail">\n            ').concat(e,"\n        </div>")}},{key:"getViewMarkup",value:function(e){var t="";switch(e.type){case"groups":t=e.groups.join("");break;case"services":t=e.services.join("")}return this.wrapper(this.getContent(t))}},{key:"getServiceMarkup",value:function(e){return'\n            <div class="'.concat(i,'-view-service line"  ').concat(o,'service="').concat(e.id,'" ').concat(o,'status="').concat(e.status,'">\n                <div>\n                    <div class="').concat(i,'-view-service-name">').concat(G(e.name),'</div>\n                    <div class="').concat(i,'-view-service-description">').concat(G(e.description),'</div>\n                </div>\n                <div>\n                    <button data-egdpr-service-toggle="').concat(e.id,'">\n                        <span class="enable">').concat(G("Activer"),'</span>\n                        <span class="disable">').concat(G("Désactiver"),"</span>\n                    </button>  \n                </div>\n            </div>\n        ")}},{key:"getGroupMarkup",value:function(e,t){return'\n        <div class="'.concat(i,'-view-group">\n            <div class="').concat(i,'-view-group-head line" ').concat(o,'group="').concat(e.id,'" ').concat(o,'status="').concat(e.status,'">\n                <div>\n                    <div class="').concat(i,'-view-group-name">').concat(e.name," ").concat(e.isMandatory()?"<span class='mandatory'>".concat(G("(nécessaire au fonctionnement du site)"),"</span>"):"",'</div>\n                    <div class="').concat(i,'-view-group-description">').concat(e.description,'</div>\n                    <div class="').concat(i,'-view-group-detail">\n                        <a class="more" href="Javascript:void();" data-egdpr-group-toggle-detail="').concat(e.id,'">Detail</a>  \n                    </div>\n                </div>\n                <div class="').concat(i,'-view-group-quick question">\n                    <button data-egdpr-group-toggle="').concat(e.id,'">\n                        <span class="enable">').concat(G("Tout activer"),'</span>\n                        <span class="disable">').concat(G("Tout désactiver"),'</span>\n                    </button>\n                </div>\n            </div>\n\n            <div class="').concat(i,'-view-group-services">\n                ').concat(t.join(""),"\n            </div>\n        </div>\n        ")}},{key:"html",value:function(e,t){return G(e,t)}},{key:"getUngroupedTitle",value:function(){return G("Autre")}},{key:"getShowPromise",value:function(){}},{key:"getHidePromise",value:function(){}}])&&$(n.prototype,r),s&&$(n,s),u}(U);function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oe={init:function(){}},se=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeoutValue=200,this.rebuildTimeout=null,this.needsRebuild("all")}var t,n,r;return t=e,(n=[{key:"init",value:function(){var e=this;if(!this.template)throw"".concat(i," :  No template defined");return this.setTemplate(this.template),Re.on(b).subscribe((function(t){e.needsRebuild(t.data?t.data.type:"all",t.data?t.data.data:{})})),Re.on(M).subscribe((function(t){return e.needsRebuild("service",t.data)})),Re.on(E).subscribe((function(t){return e.needsRebuild("all",{})})),Re.on(c).subscribe((function(t){return e.needsRebuild("group",t.data)})),Re.on(u).subscribe((function(t){return e.needsRebuild("all",{})})),this}},{key:"needsRebuild",value:function(e,t){var n=this;switch(this._needsRebuildData=this._needsRebuildData||[],e){case"all":this.hasToRebuildAll()||(this._needsRebuildData=[{type:"all"}]);break;case"group":this.hasToRebuildGroup(t.group)&&this._needsRebuildData.push({type:"group",element:t.group});break;case"service":this.hasToRebuildService(t.service)&&this._needsRebuildData.push({type:"service",element:t.service})}return window.clearTimeout(this.rebuildTimeout),this.rebuildTimeout=window.setTimeout((function(){return n.rebuild()}),this.timeoutValue),this}},{key:"hasToRebuildAll",value:function(){return this._needsRebuildData&&this._needsRebuildData.filter((function(e){return"all"===e.type})).length>0}},{key:"hasToRebuildGroup",value:function(e){return!this.hasToRebuildAll()}},{key:"hasToRebuildService",value:function(e){return!this.hasToRebuildAll()}},{key:"getTemplate",value:function(){return this.template}},{key:"setTemplate",value:function(e){var t=e;return this.isTemplate(e)||(t=this.overrideTemplate(e,Re.logsAreEnabled()))?((this.template!=t||t.force)&&(this.template=t,this.template.initTemplate(),this.template.init(),Re.trigger(b,{type:"all"})),this):(Re.logsAreEnabled()&&console.error("Bad template"),this)}},{key:"overrideTemplate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;if(a(oe,e,t)){for(var r in n=new re,e)n[r]=e[r];Object.getOwnPropertyNames(Object.getPrototypeOf(e)).indexOf("init")>-1&&(Object.getOwnPropertyNames(Object.getPrototypeOf(e)).map((function(t){n[t]=e[t]})),"function"==typeof e.getDefaultTranslations&&n.setTranslations(e.getDefaultTranslations()),"function"==typeof e.getDefaultCssList&&n.setCssList(e.getDefaultCssList()))}return n}},{key:"isTemplate",value:function(e){return e instanceof re}},{key:"rebuild",value:function(){var e=this;return this._needsRebuildData&&this.view&&(this.hasToRebuildAll()?Re.getServiceManager().getServicesList().length?this.view.innerHTML=this.getViewMarkup():this.view.innerHTML=this.template.getNoServiceMarkup():this._needsRebuildData.map((function(t){var n="";switch(t.type){case"service":n=e.template.getServiceMarkup(t.element);break;case"group":n=e.template.getGroupMarkup(t.element,e.getServicesMarkupList(t.element.getServicesList()))}var r="[".concat(o,"view-").concat(t.type,'="').concat(t.element.id,'"]');e.view.querySelectorAll(r).forEach((function(e){e.innerHTML=n}))})),Re.trigger(w),this._needsRebuildData=null),this}},{key:"getViewElement",value:function(){return this.view||(this.view=document.createElement("div"),this.view.setAttribute(o+"view",""),this.rebuild()),this.view}},{key:"getViewMarkup",value:function(){var e=this.getContentMarkupFromData(this.getViewData());return this.template.getViewMarkup(e)}},{key:"getViewData",value:function(){var e={},t=Re.getGroupManager(),n=Re.getServiceManager(),r=t.getGroupsList();return r.length&&(e.type="group",e.data={},e.data.groups=r,e.data.ungrouped_services=t.getUnGroupedServices(),e.data.ungrouped_services.length!==n.getServicesList().length)||(e.type="services",e.data={},e.data.services=Re.getServiceManager().getServicesList()),e}},{key:"getContentMarkupFromData",value:function(e){var t="";switch(e.type){case"group":t=this.getContentForGroupedView(e.data);break;case"services":t=this.getContentForServicesView(e.data);break;default:t=""}return t}},{key:"getContentForGroupedView",value:function(e){var t=this,n={type:"groups",groups:[]};return e.groups.map((function(e){n.groups.push(t.getGroupMarkup(e))})),e.ungrouped_services.length&&n.groups.push(this.getUngroupedMarkup(e.ungrouped_services)),n}},{key:"getContentForServicesView",value:function(e){return{type:"services",services:this.getServicesMarkupList(e.services)}}},{key:"getServicesMarkupList",value:function(e){var t=this;return e.map((function(e){return"<div ".concat(o,'view-service="').concat(e.id,'">').concat(t.template.getServiceMarkup(e),"</div>")}))}},{key:"getUngroupedMarkup",value:function(e){var t=Re.createGroup("default",this.template.getUngroupedTitle(),"");return e.map((function(e){return t.addService(e)})),this.getGroupMarkup(t,this.getServicesMarkupList(e))}},{key:"getGroupMarkup",value:function(e){var t=e.getServicesList();if(t.length){var n=this.getServicesMarkupList(t);return"<div ".concat(o,'view-group="').concat(e.id,'">').concat(this.template.getGroupMarkup(e,n),"</div>")}return""}}])&&ie(t.prototype,n),r&&ie(t,r),e}());function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ue=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view=se}var t,n,r;return t=e,(n=[{key:"init",value:function(){this.view.init(),this.initBehaviors(),this.initActions()}},{key:"initActions",value:function(){var e=this;this.addAction("all-enable",(function(){Re.getServiceManager().enableAll(),e.hide()})),this.addAction("all-disable",(function(){Re.getServiceManager().disableAll(),e.hide()})),this.addAction("view-toggle-detail",(function(){return e.toggleDetailPanel()})),this.addAction("view-hide",(function(){return e.hide()})),this.addAction("view-show",(function(){return e.show()})),this.addAction("group-toggle-detail",(function(t){e.view.view.querySelector("[".concat(o,'view-group="').concat(t.elemId,'"]')).classList.toggle(i+"-detail")})),this.addAction("group-toggle",(function(e){e.group.toggleAll()})),this.addAction("service-enable",(function(e){Re.getServiceManager().enableService(e.service)})),this.addAction("service-disable",(function(e){Re.getServiceManager().disableService(e.service)})),this.addAction("service-toggle",(function(e){Re.getServiceManager().toggleService(e.service)}))}},{key:"getView",value:function(){return this.view}},{key:"isDisplayed",value:function(){return document.querySelector("[".concat(o,"view]"))}},{key:"show",value:function(){var e=this;if(!this.isDisplayed()){this.body.append(this.view.getViewElement()),Re.trigger(m,{});try{this.getView().getTemplate().getShowPromise().then((function(){e._doShow()}))}catch(e){this._doShow()}}}},{key:"_doShow",value:function(){this.body.classList.add(i+"-on")}},{key:"hide",value:function(){var e=this;if(this.isDisplayed()){Re.testMode||(Re.getServiceManager().enableService(Re.getServiceManager().getMandatoryServicesList()),Re.getServiceManager().disableService(Re.getServiceManager().getPendingServices())),Re.trigger(S,{}),this.body.classList.remove(i+"-on"),this.body.classList.remove(i+"-detail"),this.body.querySelectorAll(".egdpr-detail").forEach((function(e){e.classList.remove(i+"-detail")}));try{this.getView().getTemplate().getHidePromise().then((function(){e._doHide()}))}catch(e){this._doHide()}}}},{key:"_doHide",value:function(){this.body.removeChild(this.view.getViewElement())}},{key:"addAction",value:function(e,t){this.actions=this.actions||[],this.actions[e]=this.actions[e]||[],this.actions[e].push(t)}},{key:"initBehaviors",value:function(e,t){var n=this;document.addEventListener("click",(function(r){n.initEventOnItem(r.target,e,t)}))}},{key:"initEventOnItem",value:function(e,t,n){for(var r,i=0,s=e.attributes,a=s?s.length:0;i<a;i++)if(0===(r=s[i]).nodeName.indexOf(o)){var u=r.nodeName.split("-"),c=u.slice(2).join("-");switch(u[2]){case"service":var l=Re.getServiceManager().getServiceById(r.nodeValue);this.callAction(c,{service:l,elemId:r.nodeValue});break;case"group":var f=Re.getGroupManager().getGroupById(r.nodeValue);this.callAction(c,{group:f,elemId:r.nodeValue});break;case"view":case"all":this.callAction(c,{})}}e.parentNode&&this.initEventOnItem(e.parentNode,t,n)}},{key:"callAction",value:function(e,t){this.actions=this.actions||[],this.actions[e]=this.actions[e]||[],this.actions[e].map((function(e){e(t)}))}},{key:"toggleDetailPanel",value:function(){this.body.classList.toggle(i+"-detail")}},{key:"detailPanelIsOpen",value:function(){return this.body.classList.contains(i+"-detail")}},{key:"initDomData",value:function(){window.setTimeout((function(){document.querySelectorAll("[".concat(o,"service][").concat(o,"status]")).forEach((function(e){var t=Re.getServiceManager().getServiceById(e.getAttribute(o+"service"));t&&e.setAttribute("".concat(o,"status"),t.status)})),document.querySelectorAll("[".concat(o,"group][").concat(o,"status]")).forEach((function(e){var t=Re.getGroupManager().getGroupById(e.getAttribute(o+"group"));t&&e.setAttribute("".concat(o,"status"),t.status)}))}),10)}},{key:"body",get:function(){return this._body||(this._body=document.querySelector("body")),this._body}}])&&ae(t.prototype,n),r&&ae(t,r),e}()),ce=function(e,t){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function le(e,t){function n(){this.constructor=e}ce(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function fe(e){return"function"==typeof e}var he=!1,ve={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;he=e},get useDeprecatedSynchronousErrorHandling(){return he}};function pe(e){setTimeout((function(){throw e}),0)}var de={closed:!0,next:function(e){},error:function(e){if(ve.useDeprecatedSynchronousErrorHandling)throw e;pe(e)},complete:function(){}},ge=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();var ye=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),be=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n,r=this._parentOrParents,i=this._unsubscribe,o=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var s=0;s<r.length;++s){r[s].remove(this)}if(fe(i))try{i.call(this)}catch(e){t=e instanceof ye?we(e.errors):[e]}if(ge(o)){s=-1;for(var a=o.length;++s<a;){var u=o[s];if(null!==(n=u)&&"object"==typeof n)try{u.unsubscribe()}catch(e){t=t||[],e instanceof ye?t=t.concat(we(e.errors)):t.push(e)}}}if(t)throw new ye(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function we(e){return e.reduce((function(e,t){return e.concat(t instanceof ye?t.errors:t)}),[])}var me=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Se=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=de;break;case 1:if(!n){o.destination=de;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new ke(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new ke(o,n,r,i)}return o}return le(t,e),t.prototype[me]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(be),ke=function(e){function t(t,n,r,i){var o,s=e.call(this)||this;s._parentSubscriber=t;var a=s;return fe(n)?o=n:n&&(o=n.next,r=n.error,i=n.complete,n!==de&&(fe((a=Object.create(n)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=o,s._error=r,s._complete=i,s}return le(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;ve.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=ve.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):pe(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;pe(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};ve.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),ve.useDeprecatedSynchronousErrorHandling)throw e;pe(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!ve.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return ve.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(pe(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Se);var _e=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function Oe(){}function Te(e){return e?1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}:Oe}var Ee=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof Se)return e;if(e[me])return e[me]()}return e||t||n?new Se(e,t,n):new Se(de)}(e,t,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||ve.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),ve.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){ve.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof Se?r:null}return!0}(e)?console.warn(t):e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Me(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[_e]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:Te(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Me(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Me(e){if(e||(e=ve.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var De=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),Pe=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return le(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(be),je=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return le(t,e),t}(Se),Le=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return le(t,e),t.prototype[me]=function(){return new je(this)},t.prototype.lift=function(e){var t=new Ae(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new De;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new De;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new De;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new De;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new De;return this.hasError?(e.error(this.thrownError),be.EMPTY):this.isStopped?(e.complete(),be.EMPTY):(this.observers.push(e),new Pe(this,e))},t.prototype.asObservable=function(){var e=new Ee;return e.source=this,e},t.create=function(e,t){return new Ae(e,t)},t}(Ee),Ae=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return le(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):be.EMPTY},t}(Le);function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xe=n(2),Re=new(function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logs=!1,this.testMode=!1,this.autoShow=!0,this.observables=[],this.viewManager=ue,this.serviceManager=X,this.groupManager=T,this.localManager=V,this.autoShowCallback=function(){(t.testMode||t.serviceManager.getPendingServices().length)&&t.showView()}}var t,n,r;return t=e,(n=[{key:"init",value:function(){var e=this;return this.serviceManager.init(),this.groupManager.init(),this.viewManager.init(),this.localManager.init(),this.getServiceManager().getEnabledServicesList().map((function(t){e.getServiceManager().startService(t)})),this.autoShow&&(window.removeEventListener("DOMContentLoaded",this.autoShowCallback),window.addEventListener("DOMContentLoaded",this.autoShowCallback)),this.on(D).subscribe((function(t){return e.initDomData()})),this}},{key:"allowTryRegionalisation",value:function(){return this.localManager.allowTryRegionalisation(),this}},{key:"disableLogs",value:function(){return this.logs=!1,this}},{key:"logsAreEnabled",value:function(){return this.logs}},{key:"getServiceManager",value:function(){return this.serviceManager}},{key:"getGroupManager",value:function(){return this.groupManager}},{key:"getViewManager",value:function(){return this.viewManager}},{key:"getLocalManager",value:function(){return this.localManager}},{key:"disableAutoShow",value:function(){return this.autoShow=!1,window.removeEventListener("DOMContentLoaded",this.autoShowCallback),this}},{key:"trigger",value:function(e,t){return this.logs&&console.log("Trigger ".concat(e),t),this._observableIsDefined(e)&&this.observables[e].next({name:e,data:t}),this}},{key:"on",value:function(e){return this._observableIsDefined(e)||(this.observables[e]=new Le),this.observables[e]}},{key:"_observableIsDefined",value:function(e){return this.observables&&this.observables[e]&&"function"==typeof this.observables[e].next}},{key:"createService",value:function(e){return this.serviceManager.createService(e)}},{key:"addService",value:function(e){return this.serviceManager.createService(e),this}},{key:"createGroup",value:function(e,t,n){return this.groupManager.createGroup(e,t,n)}},{key:"showView",value:function(){return this.viewManager.show(),this}},{key:"hideView",value:function(){return this.viewManager.hide(),this}},{key:"setTemplate",value:function(e){return this.viewManager.getView().setTemplate(e),this}},{key:"addScript",value:function(e,t){return xe(e,t),this}},{key:"removeScript",value:function(e){return document.querySelectorAll('script[src="'+e+'"]').forEach((function(e){return e.remove()})),this}},{key:"addCss",value:function(e,t){var n=document.querySelector("head"),r=document.createElement("link");return r.rel="stylesheet",r.type="text/css",r.href=e,r.media=t||"all",n.appendChild(r),this}},{key:"removeCss",value:function(e){return document.querySelectorAll('link[href="'+e+'"]').forEach((function(e){return e.remove()})),this}},{key:"initDomData",value:function(){return this.viewManager.initDomData(),this}},{key:"addTranslation",value:function(e){return this.getViewManager().getView().getTemplate().addTranslation(e),this}}])&&Ce(t.prototype,n),r&&Ce(t,r),e}()),Ve=Re,Ge=Y;if(window[i]){var Ie=window[i];for(var Ue in window[i]=Re,Ie)window[i][Ue]=Ie[Ue]}else window[i]=Re}]);